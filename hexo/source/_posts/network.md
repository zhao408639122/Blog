---
title: 计算机网络复习笔记
date: 2020-06-09 08:57:35
tags:
---

## 概论

资源共享、信息传递

计算机网络是互连的、自治 的计算机集合

#### 1.组成部分

硬件、软件、协议

#### 2.工作方式 

+ 边缘部分：客户直接使用 C/S P2P
+ 核心部分

#### 3.功能组成

数据通信 资源共享

+ 资源子网
+ 数据子网

![image-20200609094624467](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200609131351.png)

#### 4.分类

广域网 WAN 交换技术

城域网 MAN

局域网 WAN 广播技术

个人区域网 PAN

交换技术分类：电路交换 报文交换 分组交换

传输技术分类：

+ 广播式网络
+ 点对点网络： 存储转发 和 交换技术

OSI 七层结构

带宽：理论最大数据传输速率

吞吐量：实际数据传输速率

时延： 发送时延、传播时延、排队时延、处理时延

时延带宽积：整个管道中的数据量

往返实验RTT：从 发送方发送数据开始到发送方到接收方的确认。 

RTT越大，确认帧到来之前可发送的数据越多，正确

![image-20200609122528250](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200609131400.png)

#### 5.分层结构

上层使用下层的服务

接口：上层使用下层服务的入口。

7层OSI参考模型 法定标准

4层TCP/IP参考模型 事实标准

下三层是点到点，上四层是端到端

数据链路层加头加尾，其他都只加头部

#### 6.OSI七层模型

**应用层** FTP， SMTP， HTTP

**传输层**功能： 可靠传输、不可靠传输、差错控制、流量控制、复用分用

传输单位：报文段或用户数据报

**网络层**功能：路由选择、流量控制、差错控制、拥塞控制

传输单位：数据报

协议：IP、IPX、ICMP、IGMP、ARP、RARP、OSPF

**数据链路层**功能：成帧、差错控制（帧错、位错）、流量控制、访问（接入）控制

协议：SDLC、HDLC、PPP、STP

**物理层**功能：定义接口特性、定义传输模式（单工、双工、半双工）、定义传输速率、比特同步、比特编码 

协议 Rj45，802.3

#### 7.TCP/IP模型

![image-20200609130616920](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200609131408.png)

相同点：

1. 都分层
2. 基于独立的协议栈的概念
3. 可以实现异构网络互联

不同点：

1. OSI定义三点：服务、协议、接口
2. OSI先出现，参考模型先于协议发明，不偏向特定协议
3. TCP/IP设计之初就考虑到异构网络互联问题，将IP作为重要层次。

![image-20200609131049662](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200609131415.png)

5层参考模型综合了OSI和TCP/IP的优点

![image-20200609131157272](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200609131423.png)

## 物理层

### 基本概念

1. 机械特性：定义物理连接的特性，规定物理连接时所用的规格、接口形状、引线数目和排列情况
2. 电气特性：规定传输二进制位时，线路上信号的电压范围、阻抗匹配、传输速率和传输距离等
3. 功能特性：指明某条线上出现的某一电平表示何种意义，接口部件的信号线的用途
4. 规程特性：定义各条物理线路的工作规程和时序关系

### 数据通信

码元：固定时长的数字脉冲，代表不同离散数值的基本波形

速率：数据的传输速率，可以用码元传输速率和信息传输速率表示

码元传输速率：1s内传输多少码元 

信息传输速率：1s传输多少个比特

带宽：最高数据率 b/s

### 奈氏准则

**失真**：带宽有限、有噪声、干扰

影响失真的因素：

+ 码元传输速率
+ 信号传输距离
+ 噪声干扰
+ 传输媒体质量

#### 码间串扰

![image-20200611205823204](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230441.png)

接收端收到的信号波形失去了码元之间清晰界限的现象

#### 奈奎斯特定理

在理想低通（无噪声，带宽受限）条件下，为了避免码间串扰，极限码元传输速率为2W Baud，W是信号带宽，单位是Hz

理想低通信道下的极限数据传输率 $= 2Wlog_2V(b/s)$

V是码元的离散电平数目。

由于码元传输速率受奈奎斯特定理制约，但信息传输速率并没有限制，所以想要提高数据的传输速率，可以使码元携带更多比特信息量

### 香农定理

噪声存在于所有的电子设备核通信信道中，由于噪声随机产生，它的瞬时值有时会很大，因此噪声会使接收端对码元的判决产生错误。但是噪声的影响是相对的，若信号较强，那么噪声影响相对较小，因此，信噪比就很重要。
$$
dB = 10log_{10}(S/N)
$$
信道的极限数据传输速率 $=Wlog_2(1 + S/N) \enspace (b/s)$

+ 带宽或信噪比越大，信息的极限传输速率越高
+ 只要速率小于极限值，就一定可以找到方法实现无差错传输
+  求出的是极限速度，实际比求出的低

实际选用中，如果给出信噪比，则应取两公式较小值

###  编码与调制

#### 基带信号与宽带信号

![image-20200611220347595](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230453.png)

基带信号：将数字信号1和0直接用两种不同的电压表示，再送到数字信道上去传输（基带传输）。来自信源的信号，像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。基带信号就是发初的直接表达了要传输的信息的信号，比如我们说话的声波就是基带信号。

宽带信号：将基带信号进行调制后形成的频分复用模拟信号，在传送到模拟信道上去传输（宽带传输）把基带信号经过调制载波后，把信号的频率范围搬移到较高的频段以便在信道中传输（即仅在一段频率范围内能够通过信道）（通带传输）

近距离一般使用基带传输，远距离一般使用宽带传输。

编码：数据 ——》数字信号

调制：数据 ——》模拟信号

![image-20200611222424172](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230501.png)

### 数字数据编码为数字信号

+ 非归零编码（NRZ）
+ 曼切斯特编码
+ 差分曼切斯特编码
+ 归零编码 RZ
+ 反向不归零编码 NRZI
+ 4B/5B编码

![image-20200611222657336](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230510.png)

#### 非归零编码

容易实现，没有检错功能，难以保持同步

#### 归零编码 

信号在一个码元内都要归0.

#### 反向不归零编码

<img src="https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230535.png" alt="image-20200611222831713" style="zoom: 80%;" />

信号翻转表示0，信号电平不变保持1

#### 曼彻斯特编码 

前高后低为1，前低后高为0，所占频带宽度是原始基带宽度的两倍。

数据传输速率只有调制速率的1/2

#### 差分曼切斯特编码

若码元为1，则前半个码元电平与上一个码元的后半个码元的电平相同，若为0，则相反。在每个码元中间都有一次电平的跳转，可实现自同步，抗干扰性强于曼切斯特编码

#### 4B/5B编码

用五个比特表示四个比特，编码效率为百分之八十

### 数字数据调制为模拟信号

 <img src="https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200611230541.png" alt="image-20200611224735812" style="zoom: 80%;" />

### 模拟数据编码为数字信号

PCM 最高保真水平

1. 抽样：采样定理：采样频率 >= 2 * 信号最高频率
2. 量化：按照分级标度转化为相应的数字值
3. 编码：把量化结果转化为与之对应的二进制编码

### 模拟数据调制为模拟信号

可以使用频分复用集树，充分利用带宽资源。

### 传输介质

### 网络设备

#### 集线器

多口中继器，对信号进行再生放大转发。

机器平分带宽

## 介质访问控制子层

#### 两种链路

点对点链路：PPP协议，常用于广域网

广播式链路：所有主机共享通信介质，早期总线以太网，无线局域网

典型拓扑结构：总线型、星型 

![image-20200614220522586](C:\Users\Clover\AppData\Roaming\Typora\typora-user-images\image-20200614220522586.png)

### 信道划分介质访问控制

将使用介质的每个设备与来自同一信道上的其他设备的通信隔离开，把时域和频域资源合理地分配给网络上的设备

#### FDM

 每个用户占用一个频段

#### TDM

将时间划分为等长的时分复用帧，每个用户轮流占用信道

####  STDM 统计时分复用

发送频率比较低，和TDM完全不同

![image-20200614204528740](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614204622.png)

#### WDM 波分多路复用

光的频分多路复用

#### CDM 码分多路复用

区别CDMA（码分多址）是码分复用的一种方式。

### 动态分配信道

只有随机访问MAC协议会发生冲突

#### ALOHA协议

思想：不监听信道，不按时间槽发送，随机重发

![image-20200614211719439](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614213439.png)

按照概率P来进行重发，发送成功会收到确认帧。

#### 时隙ALOHA协议

把时间分成若干个相同的时间片，每个站点只能在时间片的开始才能开始发送，如果冲突则重传

#### CSMA协议 

载波监听多路访问协议 

发送帧之前，监听信道，如果忙则推迟发送

##### 1-坚持CSMA

如果信道空闲，不必等待，否则一直监听，直到空闲马上传输

如果有冲突，则等待一个随机的时间再监听

优点：只要空闲，就马上发送，媒体利用率高

##### 非坚持CSMA

对于信道忙之后就不再继续监听。

如果信道忙，等待随机的时间后再去监听

优点：采用随机的重发延迟时间可以减少冲突发生的可能性

##### p-坚持CSMA

如果空闲，则以p概率直接传输，否则概率 1-p 等待到下一个时间槽进行传输

忙则等待一个随机的时间再次监听

结合两点优点

但是CSMA发生冲突后还是要坚持把数据帧发送完，造成了浪费。

![image-20200614213430705](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614213450.png)

### CSMA/CD协议（无冲突协议）

碰撞检测CSMA，适用于半双工网络，总线型网络（多点接入）

![image-20200614223200032](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614223205.png)

![image-20200614223529330](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614223931.png)

**注意当K>10的情况下视作k等于10**

因为可能碰撞检测到时就已经发送完整个帧，所以需要定义最小帧长 

<img src="https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200614223954.png" alt="image-20200614223822273" style="zoom:67%;" />

以太网最短帧长为64字节

### CSMA/CA协议

碰撞避免CSMA

CA适用于无线局域网，CD适用于以太网

不能使用CD的原因

1. 无法做到全面检测碰撞
2. 隐蔽站

发送数据之前，先检测信道是否空闲

空闲发出RTS（Request to send），包括发送端地址、接收端地址、下一份数据将持续发送的时间信息，时间忙则等待

接收端收到RTS之后，返回CTS（Clear to send）

发送端收到CTS后，开始发送数据帧（同时预约信道，发送方告知其他站点自己谣传多久数据）

接收端收到数据帧后，将用CRC来检验数据是否正确，正确则响应ACK帧

发送方收到ACK就可以进行下一个数据帧的发送，若没有则一直重传直到规定重发次数为止（采用二进制指数退避算法来确定随机的推迟时间）

1. 预约信道
2. ACK帧
3. RTS/CTS帧（可选）解决隐蔽站问题

### 轮询访问MAC协议

#### 轮询协议

主结点轮流邀请从属结点发送数据

问题：

+ 轮询开销
+ 等待延迟 靠后结点等待延迟
+ 单点故障，主结点宕机影响很大

####  令牌传递协议

![image-20200614214921139](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615000934.png)

## 局域网

![image-20200614230536403](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615000943.png)

介质访问控制方法

1. CSMA/CD，总线型局域网
2. 令牌总线，总线型局域网
3. 令牌环，用于环形局域网

以太网标准为 802.3

无线局域网标准为 802.11

![image-20200614231130398](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001026.png)

### 以太网MAC帧

![image-20200614232858893](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001035.png)

此处的地址为MAC地址

![image-20200614233116907](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001042.png)

### 802.11帧格式

P239

![image-20200614233453041](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001047.png)

### 广域网

使用分组交换技术

#### PPP协议

点对点协议，只支持全双工线路

无需纠错，无需序号，无需流量控制

封装成帧、透明传输，满足多种网络层协议，满足多种类型链路，实现差错检测，检测连接状态，MTU：1500字节

不需要流量控制，纠错，序号，多点链路

组成部分：

1. 将IP数据包封装到串行链路的方法
2. 链路控制协议LCP：建立并维护数据链路连接（身份验证）
3. 网络控制协议NCP：PPP可支持多种网络层协议，每个不同的网络层协议都要一个相应的NCP来配置，为网络层协议建立和配置逻辑连接

<img src="https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001058.png" alt="image-20200614235102577" style="zoom:67%;" />

PPP协议使用字节填充法

<img src="https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001104.png" alt="image-20200614235240815" style="zoom: 50%;" />

**HDLC 高级数据链路控制协议**

HDLC使用比特填充，有序号和确认机制，可靠传输

### 网桥

网桥根据MAC帧的目的地址对帧进行转发和过滤。当网桥收到一个帧时，并不像所有接口转发此帧，而是先检查此帧的目的MAC地址，然后再确定将该帧转发到哪一个接口，或者是把他丢弃（即过滤）。

**网段**：一般指一个计算机网络中使用同一物理层设备能够直接通讯的那一部分

#### 学习网桥（透明网桥）

即插即用

1. A—> B

![image-20200615000748115](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001112.png)

2. F —>C

![image-20200615000844657](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001119.png)

3. B—>A

![image-20200615000904423](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001127.png)



![image-20200615001511021](https://raw.githubusercontent.com/zhao408639122/Picbed/master/blog/20200615001616.png)

交换机一个口就是一个冲突域

路由器一个口就是一个广播域